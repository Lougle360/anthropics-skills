<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>阶段五操作手册 - 工具开发</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.6; color: #333; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; position: relative; }
        .back-link { position: absolute; top: 20px; left: 20px; color: white; text-decoration: none; padding: 8px 15px; background: rgba(255,255,255,0.2); border-radius: 25px; }
        header h1 { font-size: 2.2em; margin-bottom: 10px; }
        .content { padding: 40px; }
        .manual-section { margin-bottom: 50px; }
        .section-title { font-size: 2em; color: #667eea; margin-bottom: 30px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .subsection { margin-bottom: 30px; }
        .subsection h3 { font-size: 1.5em; color: #555; margin-bottom: 20px; padding-left: 15px; border-left: 5px solid #667eea; }
        .topic-block { background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #667eea; }
        .topic-block h4 { color: #667eea; margin-bottom: 15px; font-size: 1.3em; }
        .code-block { background: #f5f5f5; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; margin: 15px 0; overflow-x: auto; border: 1px solid #ddd; }
        .info-box { background: #e7f3ff; padding: 20px; border-radius: 10px; border-left: 5px solid #007bff; margin: 20px 0; }
        .guide-section { background: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; border: 2px solid #e0e0e0; }
        .footer { background: #f8f9fa; padding: 30px 40px; text-align: center; border-top: 2px solid #e0e0e0; }
        .footer-link { padding: 12px 30px; background: #667eea; color: white; text-decoration: none; border-radius: 25px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../index.html" class="back-link">← 返回首页</a>
            <h1>阶段五操作手册</h1>
            <div class="subtitle">工具开发技能详解</div>
        </header>
        <div class="content">
            <div class="manual-section">
                <h2 class="section-title">第一部分：深度知识点</h2>
                <div class="subsection">
                    <h3>1. MCP 协议详解</h3>
                    <div class="topic-block">
                        <h4>JSON-RPC 通信机制</h4>
                        <p>MCP 使用 JSON-RPC 2.0 协议：</p>
                        <ul>
                            <li>请求：包含 method（方法）、params（参数）、id（请求ID）</li>
                            <li>响应：包含 result（结果）或 error（错误）、id（对应请求ID）</li>
                            <li>通知：单向消息，不期待响应</li>
                        </ul>
                        <div class="code-block">
{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "weather_get",
    "arguments": {
      "location": "San Francisco"
    }
  },
  "id": 1
}
                        </div>
                    </div>
                    <div class="topic-block">
                        <h4>工具定义规范</h4>
                        <p>每个工具必须包含：</p>
                        <ul>
                            <li>name：唯一标识符</li>
                            <li>description：工具功能的描述</li>
                            <li>inputSchema：输入参数的 JSON Schema</li>
                            <li>outputSchema：输出格式的 JSON Schema</li>
                        </ul>
                    </div>
                </div>
                <div class="subsection">
                    <h3>2. 技能设计深度</h3>
                    <div class="topic-block">
                        <h4>设计原则详解</h4>
                        <ul>
                            <li><strong>目标明确</strong>：技能应该解决特定、明确的问题</li>
                            <li><strong>范围有限</strong>：避免过于宽泛，保持聚焦</li>
                            <li><strong>简洁指令</strong>：使用清晰、简洁的语言</li>
                            <li><strong>示例驱动</strong>：提供多个实际使用示例</li>
                            <li><strong>可验证性</strong>：技能效果应该可以验证</li>
                        </ul>
                    </div>
                    <div class="topic-block">
                        <h4>指令编写技巧</h4>
                        <ol>
                            <li>使用标题组织内容</li>
                            <li>提供使用场景和示例</li>
                            <li>明确输入和输出要求</li>
                            <li>处理边缘情况和错误</li>
                            <li>包含故障排除建议</li>
                        </ol>
                    </div>
                </div>
                <div class="subsection">
                    <h3>3. GIF 编码技术</h3>
                    <div class="topic-block">
                        <h4>颜色量化算法</h4>
                        <p>减少图像颜色数量到 256：</p>
                        <ul>
                            <li><strong>流行色算法</strong>：基于出现频率选择颜色</li>
                            <li><strong>中位切割</strong>：将颜色空间分成区域</li>
                            <li><strong>八叉树</strong>：递归分割颜色空间</li>
                        </ul>
                    </div>
                    <div class="topic-block">
                        <h4>缓动函数实现</h4>
                        <div class="code-block">
// 缓动函数
function easeInOutQuad(t) {
    return t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2;
}

function easeOutBack(t) {
    const c1 = 1.70158;
    const c3 = c1 + 1;
    return 1 + c3 * Math.pow(t - 1, 3) + c1 * Math.pow(t - 1, 2);
}

// 应用到动画进度
for (let i = 0; i < frames.length; i++) {
    let t = i / (frames.length - 1);
    let easedT = easeInOutQuad(t);
    // 使用 easedT 进行插值
}
                        </div>
                    </div>
                </div>
            </div>

            <div class="manual-section">
                <h2 class="section-title">第二部分：操作指南</h2>
                <div class="guide-section">
                    <h4>1. MCP 服务器完整实现流程</h4>
                    <ol>
                        <li>初始化项目：使用 MCP SDK（Python 或 TypeScript）</li>
                        <li>定义工具：创建工具列表和 Schema</li>
                        <li>实现工具逻辑：编写处理函数</li>
                        <li>添加资源：可选的资源（文件、数据库）</li>
                        <li>实现 JSON-RPC 处理：请求路由和响应构建</li>
                        <li>添加错误处理：验证输入、处理异常</li>
                        <li>编写文档：README、API 文档</li>
                        <li>测试与 Claude 集成：使用 MCP 客户端测试</li>
                        <li>部署和发布：打包为可安装格式</li>
                    </ol>
                    <div class="info-box">
                        <strong>最佳实践：</strong>使用类型检查（TypeScript）确保类型安全，添加完整的文档和示例。
                    </div>
                </div>

                <div class="guide-section">
                    <h4>2. 自定义技能开发流程</h4>
                    <ol>
                        <li>需求分析：确定技能的目标和范围</li>
                        <li>设计结构：规划内容组织和章节</li>
                        <li>编写 YAML frontmatter：定义元数据字段</li>
                        <li>创建内容：编写详细的指令和示例</li>
                        <li>添加资源：创建模板、脚本、参考文档</li>
                        <li>测试技能：在不同场景下验证效果</li>
                        <li>优化迭代：根据反馈改进</li>
                        <li>编写文档：使用指南和常见问题</li>
                        <li>发布分享：发布到技能市场或内部仓库</li>
                    </ol>
                </div>

                <div class="guide-section">
                    <h4>3. GIF 制作完整流程</h4>
                    <ol>
                        <li>设计动画：确定帧序列和动画概念</li>
                        <li>创建每一帧：使用 PIL 绘制图形元素</li>
                        <li>应用缓动：使用缓动函数控制过渡</li>
                        <li>优化色彩：减少颜色数量和文件大小</li>
                        <li>设置帧率：15-30fps 适合大多数用途</li>
                        <li>设置尺寸：目标尺寸 < 500x500px</li>
                        <li>编码为 GIF：使用 PIL 的 save() 方法</li>
                        <li>测试和调整：在不同平台预览效果</li>
                        <li>进一步优化：调整颜色、帧率、尺寸</li>
                    </ol>
                    <div class="info-box">
                        <strong>优化策略：</strong>减少颜色数量、降低帧率、缩小尺寸、使用透明背景减少文件大小。
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <a href="phase4.html" class="footer-link">← 阶段四</a>
            <a href="../exercises/phase5.html" class="footer-link">返回作业 →</a>
        </footer>
    </div>
</body>
</html>